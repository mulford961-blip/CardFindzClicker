<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CardFindz Clicker- Sports Card Empire</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }

        .animate-float {
            animation: floatUp 1s ease-out forwards;
        }

        @keyframes sparkle {
            0%, 100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2) rotate(180deg);
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 10px rgba(212, 165, 116, 0.4), 0 0 20px rgba(212, 165, 116, 0.2);
            }
            50% {
                box-shadow: 0 0 20px rgba(212, 165, 116, 0.6), 0 0 40px rgba(212, 165, 116, 0.4), 0 0 60px rgba(212, 165, 116, 0.2);
            }
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 15px rgba(212, 165, 116, 0.4);
            }
            50% {
                box-shadow: 0 0 30px rgba(212, 165, 116, 0.6);
            }
        }

        @keyframes cardFlip {
            0% {
                transform: perspective(1000px) rotateY(0deg);
            }
            50% {
                transform: perspective(1000px) rotateY(180deg);
            }
            100% {
                transform: perspective(1000px) rotateY(360deg);
            }
        }

        .animate-card-flip {
            animation: cardFlip 0.6s ease-in-out;
        }

        @keyframes particle {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            animation: particle 0.8s ease-out forwards;
        }

        .animate-sparkle {
            animation: sparkle 0.6s ease-in-out;
        }

        .animate-shake {
            animation: shake 0.5s ease-in-out;
        }

        .animate-glow {
            animation: glow 1s ease-in-out infinite;
        }

        .animate-pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            transition: background-color 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&family=Playfair+Display:wght@700;900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        /* Smooth transitions for all interactive elements */
        * {
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        button {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        /* Custom Scrollbar - Dark Mode */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        .dark ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #D4A574 0%, #C2A882 100%);
            border-radius: 12px;
            border: 3px solid rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #E0B685 0%, #D4A574 100%);
            border: 3px solid rgba(0, 0, 0, 0.5);
        }

        /* Custom Scrollbar - Light Mode */
        .light ::-webkit-scrollbar-track {
            background: rgba(245, 235, 220, 0.5);
            border-radius: 12px;
        }

        .light ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #D4A574 0%, #8B7355 100%);
            border-radius: 12px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
        }

        .light ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #E0B685 0%, #A08568 100%);
            border: 3px solid rgba(255, 255, 255, 0.7);
        }

        /* Card corner decorations */
        .card-corner {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-corner::before,
        .card-corner::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            border: 2px solid currentColor;
            opacity: 0.6;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-corner:hover::before,
        .card-corner:hover::after {
            opacity: 1;
        }

        .card-corner::before {
            top: -2px;
            left: -2px;
            border-right: none;
            border-bottom: none;
            border-top-left-radius: 4px;
        }

        .card-corner::after {
            bottom: -2px;
            right: -2px;
            border-left: none;
            border-top: none;
            border-bottom-right-radius: 4px;
        }

        /* Card texture pattern */
        .card-texture {
            background-image:
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 10px,
                    rgba(212, 165, 116, 0.03) 10px,
                    rgba(212, 165, 116, 0.03) 20px
                );
        }

        /* Smooth backdrop for modals */
        .smooth-backdrop {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        /* Smooth shadows */
        .smooth-shadow {
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .smooth-shadow-lg {
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25), 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* Smooth border radius */
        .smooth-rounded {
            border-radius: 20px;
        }

        .smooth-rounded-lg {
            border-radius: 24px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons as SVG components
        const Package = ({ size = 24, className = "", strokeWidth = 2 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line>
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
        );

        const CreditCard = ({ size = 24, className = "", strokeWidth = 2 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                <line x1="1" y1="10" x2="23" y2="10"></line>
            </svg>
        );

        const TrendingUp = ({ size = 24, className = "", strokeWidth = 2 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const DollarSign = ({ size = 24, className = "", strokeWidth = 2 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const Zap = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
            </svg>
        );

        const Store = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"></path>
                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                <path d="M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"></path>
                <path d="M2 7h20"></path>
                <path d="M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7"></path>
            </svg>
        );

        const Users = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const Globe = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
        );

        const Camera = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                <circle cx="12" cy="13" r="4"></circle>
            </svg>
        );

        const Star = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>
        );

        const Trophy = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const Sun = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
        );

        const Moon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        );

        const Settings = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m0-18a3 3 0 0 0 3 3h4a2 2 0 0 1 2 2v4a3 3 0 0 0 3 3m-18 0a3 3 0 0 0 3-3V8a2 2 0 0 1 2-2h4a3 3 0 0 0 3-3"></path>
                <path d="M12 1v6m0 6v6"></path>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path>
                <line x1="12" y1="8" x2="12" y2="16"></line>
                <line x1="8" y1="12" x2="16" y2="12"></line>
            </svg>
        );

        const Volume2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
            </svg>
        );

        const VolumeX = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <line x1="23" y1="9" x2="17" y2="15"></line>
                <line x1="17" y1="9" x2="23" y2="15"></line>
            </svg>
        );


        const RefreshCw = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );

        const Bell = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
        );

        const BellOff = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                <path d="M18.63 13A17.89 17.89 0 0 1 18 8"></path>
                <path d="M6.26 6.26A5.86 5.86 0 0 0 6 8c0 7-3 9-3 9h14"></path>
                <path d="M18 8a6 6 0 0 0-9.33-5"></path>
                <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
        );

        const CardFindzTycoon = () => {
            const [theme, setTheme] = useState('dark');
            const [cash, setCash] = useState(0);
            const [totalEarned, setTotalEarned] = useState(0);
            const [clickValue, setClickValue] = useState(1);
            const [cardsPerSecond, setCardsPerSecond] = useState(0);
            const [message, setMessage] = useState('Start selling cards!');
            const [clickAnimation, setClickAnimation] = useState(false);
            const [cardFlipAnimation, setCardFlipAnimation] = useState(false);
            const [floatingNumbers, setFloatingNumbers] = useState([]);
            const [particles, setParticles] = useState([]);
            const [totalClicks, setTotalClicks] = useState(0);
            const [unlockedAchievements, setUnlockedAchievements] = useState([]);
            const [achievementNotification, setAchievementNotification] = useState(null);

            // Mini-game states
            const [showGradingGame, setShowGradingGame] = useState(false);
            const [currentCard, setCurrentCard] = useState(null);
            const [selectedGrade, setSelectedGrade] = useState(null);
            const [gameResult, setGameResult] = useState(null);
            const [gradingCooldown, setGradingCooldown] = useState(0);
            const [totalGradingGames, setTotalGradingGames] = useState(0);
            const [perfectGrades, setPerfectGrades] = useState(0);

            // Settings states
            const [showSettings, setShowSettings] = useState(false);
            const [volume, setVolume] = useState(50);
            const [soundEnabled, setSoundEnabled] = useState(true);
            const [notificationsEnabled, setNotificationsEnabled] = useState(true);

            // Sound effects using Web Audio API
            const playSound = (frequency, duration, type = 'sine') => {
                if (!soundEnabled) return;

                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = frequency;
                oscillator.type = type;

                const adjustedVolume = (volume / 100) * 0.3;
                gainNode.gain.setValueAtTime(adjustedVolume, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            };

            const playSellSound = () => {
                playSound(800, 0.1, 'sine');
                setTimeout(() => playSound(1000, 0.1, 'sine'), 50);
            };

            const playUpgradeSound = () => {
                playSound(523.25, 0.15, 'square');
                setTimeout(() => playSound(659.25, 0.15, 'square'), 100);
                setTimeout(() => playSound(783.99, 0.2, 'square'), 200);
            };

            const playSuccessSound = () => {
                playSound(659.25, 0.1, 'sine');
                setTimeout(() => playSound(783.99, 0.1, 'sine'), 80);
                setTimeout(() => playSound(987.77, 0.15, 'sine'), 160);
            };

            const playFailSound = () => {
                playSound(400, 0.15, 'square');
                setTimeout(() => playSound(300, 0.2, 'square'), 100);
            };

            const toggleTheme = () => {
                setTheme(prev => prev === 'dark' ? 'light' : 'dark');
            };


            const resetGame = () => {
                if (!confirm('Are you sure you want to reset all progress? This cannot be undone!')) {
                    return;
                }

                setCash(0);
                setTotalEarned(0);
                setTotalClicks(0);
                setUnlockedAchievements([]);
                setGradingCooldown(0);
                setTotalGradingGames(0);
                setPerfectGrades(0);
                setPortfolio(upgrades.map(inv => ({ ...inv })));
                setMessage('Game reset complete!');
                setShowSettings(false);
                playSuccessSound();
            };

            // Card grading mini-game functions
            const cardConditions = {
                10: { name: 'Gem Mint', corners: 'Perfect sharp corners', edges: 'Pristine edges', centering: 'Perfect 50/50', surface: 'Flawless surface' },
                9: { name: 'Mint', corners: 'Sharp corners', edges: 'Clean edges', centering: 'Excellent centering', surface: 'Near-perfect surface' },
                8: { name: 'NM-MT', corners: 'Very minor corner wear', edges: 'Slight edge wear', centering: 'Good centering 60/40', surface: 'Minor surface issues' },
                7: { name: 'Near Mint', corners: 'Slight corner rounding', edges: 'Minor edge chipping', centering: 'Off-center 70/30', surface: 'Light surface scratches' },
                6: { name: 'EX-MT', corners: 'Visible corner wear', edges: 'Moderate edge wear', centering: 'Poor centering 75/25', surface: 'Moderate scratches' },
                5: { name: 'Excellent', corners: 'Rounded corners', edges: 'Heavy edge wear', centering: 'Very off-center 80/20', surface: 'Heavy scratches' },
                4: { name: 'VG-EX', corners: 'Heavily rounded', edges: 'Significant chipping', centering: 'Badly off-center', surface: 'Multiple defects' },
                3: { name: 'Very Good', corners: 'Major rounding', edges: 'Extensive wear', centering: 'Extremely off-center', surface: 'Heavy defects' },
                2: { name: 'Good', corners: 'Severe damage', edges: 'Major damage', centering: 'Terrible centering', surface: 'Severe damage' },
                1: { name: 'Poor', corners: 'Extreme damage', edges: 'Extreme damage', centering: 'Worst possible', surface: 'Destroyed surface' }
            };

            const generateRandomCard = () => {
                const grade = Math.floor(Math.random() * 10) + 1; // 1-10
                const playerName = ['Michael Jordan', 'LeBron James', 'Tom Brady', 'Wayne Gretzky', 'Babe Ruth', 'Mickey Mantle', 'Ken Griffey Jr.', 'Derek Jeter'][Math.floor(Math.random() * 8)];
                const year = 1980 + Math.floor(Math.random() * 43); // 1980-2023
                const cardNumber = Math.floor(Math.random() * 500) + 1;

                return {
                    grade,
                    playerName,
                    year,
                    cardNumber,
                    condition: cardConditions[grade]
                };
            };

            const startGradingGame = () => {
                if (gradingCooldown > 0) {
                    setMessage(`Mini-game available in ${gradingCooldown}s`);
                    return;
                }

                const newCard = generateRandomCard();
                setCurrentCard(newCard);
                setSelectedGrade(null);
                setGameResult(null);
                setShowGradingGame(true);
            };

            const submitGrade = () => {
                if (!selectedGrade || !currentCard) return;

                const difference = Math.abs(selectedGrade - currentCard.grade);
                let reward = 0;
                let message = '';
                let isSuccess = false;

                if (difference === 0) {
                    reward = Math.floor(clickValue * 10);
                    message = 'Perfect! Exact match!';
                    isSuccess = true;
                    setPerfectGrades(prev => prev + 1);
                    playSuccessSound();
                } else if (difference === 1) {
                    reward = Math.floor(clickValue * 5);
                    message = 'Great! Within 1 grade!';
                    isSuccess = true;
                    playSuccessSound();
                } else if (difference === 2) {
                    reward = Math.floor(clickValue * 2);
                    message = 'Good! Within 2 grades!';
                    isSuccess = true;
                    playSuccessSound();
                } else {
                    reward = 0;
                    message = 'Too far off. No bonus.';
                    playFailSound();
                }

                setCash(prev => prev + reward);
                setTotalEarned(prev => prev + reward);
                setTotalGradingGames(prev => prev + 1);

                setGameResult({
                    correct: currentCard.grade,
                    selected: selectedGrade,
                    difference,
                    reward,
                    message,
                    isSuccess
                });

                // Start cooldown
                setGradingCooldown(60);
            };

            const closeGradingGame = () => {
                setShowGradingGame(false);
                setCurrentCard(null);
                setSelectedGrade(null);
                setGameResult(null);
            };

            // Cooldown timer
            useEffect(() => {
                if (gradingCooldown > 0) {
                    const timer = setTimeout(() => {
                        setGradingCooldown(prev => prev - 1);
                    }, 1000);
                    return () => clearTimeout(timer);
                }
            }, [gradingCooldown]);

            // Theme colors - CardFindz branding
            const colors = {
                dark: {
                    bg: '#000000',
                    bgSecondary: '#1a1a1a',
                    bgTertiary: '#0a0a0a',
                    text: '#ffffff',
                    textSecondary: '#9ca3af',
                    textTertiary: '#6b7280',
                    accent: '#D4A574',
                    accentHover: '#E0B685',
                    border: '#374151',
                    borderLight: '#1f2937'
                },
                light: {
                    bg: '#FAF8F5',
                    bgSecondary: '#F5F0EB',
                    bgTertiary: '#FFFFFF',
                    text: '#1a1a1a',
                    textSecondary: '#4b5563',
                    textTertiary: '#6b7280',
                    accent: '#D4A574',
                    accentHover: '#C2A882',
                    border: '#D4A574',
                    borderLight: '#E5D5C5'
                }
            };

            const currentColors = colors[theme];

            const [upgrades] = useState([
                {
                    id: 1,
                    name: 'Better Camera',
                    icon: Camera,
                    baseCost: 15,
                    owned: 0,
                    clickBonus: 1,
                    perSecond: 0,
                    description: '+$1 per sale'
                },
                {
                    id: 2,
                    name: 'eBay Store',
                    icon: Store,
                    baseCost: 100,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 1,
                    description: '$1/sec auto'
                },
                {
                    id: 3,
                    name: 'Grading Service',
                    icon: Star,
                    baseCost: 500,
                    owned: 0,
                    clickBonus: 5,
                    perSecond: 0,
                    description: '+$5 per sale'
                },
                {
                    id: 4,
                    name: 'Instagram Ads',
                    icon: Users,
                    baseCost: 1200,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 10,
                    description: '$10/sec auto'
                },
                {
                    id: 5,
                    name: 'Card Show Booth',
                    icon: Package,
                    baseCost: 5000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 60,
                    description: '$60/sec auto'
                },
                {
                    id: 6,
                    name: 'Rare Card Dealer',
                    icon: TrendingUp,
                    baseCost: 12000,
                    owned: 0,
                    clickBonus: 75,
                    perSecond: 0,
                    description: '+$75 per sale'
                },
                {
                    id: 7,
                    name: 'Online Marketplace',
                    icon: Globe,
                    baseCost: 50000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 500,
                    description: '$500/sec auto'
                },
                {
                    id: 8,
                    name: 'Card Grading Company',
                    icon: Star,
                    baseCost: 150000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 2500,
                    description: '$2.5k/sec auto'
                },
                {
                    id: 9,
                    name: 'Vintage Card Vault',
                    icon: Package,
                    baseCost: 500000,
                    owned: 0,
                    clickBonus: 500,
                    perSecond: 0,
                    description: '+$500 per sale'
                },
                {
                    id: 10,
                    name: 'Regional Distribution',
                    icon: Globe,
                    baseCost: 1000000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 8000,
                    description: '$8k/sec auto'
                },
                {
                    id: 11,
                    name: 'Card Authentication AI',
                    icon: Zap,
                    baseCost: 3500000,
                    owned: 0,
                    clickBonus: 2000,
                    perSecond: 0,
                    description: '+$2k per sale'
                },
                {
                    id: 12,
                    name: 'Auction House',
                    icon: TrendingUp,
                    baseCost: 8000000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 25000,
                    description: '$25k/sec auto'
                },
                {
                    id: 13,
                    name: 'Hall of Fame Collection',
                    icon: Star,
                    baseCost: 20000000,
                    owned: 0,
                    clickBonus: 8000,
                    perSecond: 0,
                    description: '+$8k per sale'
                },
                {
                    id: 14,
                    name: 'Sports Network Deal',
                    icon: Users,
                    baseCost: 50000000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 100000,
                    description: '$100k/sec auto'
                },
                {
                    id: 15,
                    name: '1-of-1 Card Broker',
                    icon: DollarSign,
                    baseCost: 150000000,
                    owned: 0,
                    clickBonus: 35000,
                    perSecond: 0,
                    description: '+$35k per sale'
                },
                {
                    id: 16,
                    name: 'International Empire',
                    icon: Globe,
                    baseCost: 400000000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 500000,
                    description: '$500k/sec auto'
                },
                {
                    id: 17,
                    name: 'Card Museum',
                    icon: Package,
                    baseCost: 1000000000,
                    owned: 0,
                    clickBonus: 150000,
                    perSecond: 0,
                    description: '+$150k per sale'
                },
                {
                    id: 18,
                    name: 'Blockchain Card Platform',
                    icon: Zap,
                    baseCost: 3000000000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 2000000,
                    description: '$2M/sec auto'
                },
                {
                    id: 19,
                    name: 'Legendary Card Syndicate',
                    icon: Star,
                    baseCost: 10000000000,
                    owned: 0,
                    clickBonus: 750000,
                    perSecond: 0,
                    description: '+$750k per sale'
                },
                {
                    id: 20,
                    name: 'Global Card Monopoly',
                    icon: TrendingUp,
                    baseCost: 50000000000,
                    owned: 0,
                    clickBonus: 0,
                    perSecond: 10000000,
                    description: '$10M/sec auto'
                }
            ]);

            const [portfolio, setPortfolio] = useState(upgrades.map(inv => ({ ...inv })));

            // Fake leaderboard players - spread across different earnings levels
            const generateLeaderboard = () => {
                const names = [
                    'CardKing', 'MikeCollector', 'BaseballPro', 'HoopsTrader', 'VintageVault',
                    'GradedGuru', 'RookieHunter', 'PSA_Master', 'JordanFan23', 'BradyBoss',
                    'CardShark99', 'SportsInvestor', 'DeckDealer', 'PackRipper', 'FlipMaster',
                    'GemMintGuy', 'AutoSeeker', 'PatchKing', 'SerialChaser', 'RareCardRon',
                    'ToppsTitan', 'PaniniPro', 'UpperDeckDan', 'BowmanBuff', 'StaggCollector',
                    'SlamDunkSam', 'GoalieGuru', 'PuckPro', 'GridironGreg', 'DiamondDealer',
                    'HOFHunter', 'ChaseCarter', 'MintMania', 'BoxBreaker', 'SingleSource',
                    'RawCardRick', 'SlabSeeker', 'InvestInCards', 'FlippinFast', 'CardCastle',
                    'EpicPulls', 'LegendaryLoot', 'AlphaCollector', 'OmegaInvestor', 'BetaBoxer',
                    'SigSeeker', 'MemoCatcher', 'RelicRich', 'PatchPursuer', 'NumberedNate',
                    'ParallelPete', 'RefractorRay', 'PrismPro', 'ChromeChaser', 'OpticOllie',
                    'MosaicMike', 'PrizePacker', 'SelectSam', 'DonrussDon', 'ScoreScott',
                    'FleerFanatic', 'SPxStan', 'ExquisiteEd', 'NationalTreasure', 'ImmaculateIan',
                    'FlawlessPhil', 'DynastyDave', 'ContendersCarl', 'PrestigePaul', 'CrownRoyale',
                    'LimitedLarry', 'SignaturesSteve', 'EncasedEric', 'OriginOscar', 'UltimateTom',
                    'HobbyHero', 'RetailRanger', 'BlasterBob', 'MegaboxMatt', 'HangerHank',
                    'CelloCharlie', 'RackPackRob', 'JumboJoe', 'FatPackFrank', 'TriStarTony',
                    'LeafLegend', 'SageSeeker', 'WildCardWill', 'PressPro', 'ITGIvan',
                    'InTheGameGary', 'ClassicCollector', 'HeritageHarry', 'ArchiveAlex', 'MuseumMark',
                    'TributeTrader', 'LegacyLen', 'TimelessTim', 'IconicIsaac', 'SignatureSteve2',
                    'PlatinumPete', 'GoldGary', 'SilverSid', 'BronzeBen', 'HolographicHal',
                    'MetallicMax', 'SpectralStan', 'LunarLeo', 'SolarSeth', 'CosmicCarl',
                    'GalaxyGabe', 'NebulaNoah', 'StardustStu', 'CometCody', 'MeteorMike',
                    'AsteroidAdam', 'PlanetPaul', 'OrbitOwen', 'VoidVic', 'QuantumQuinn',
                    'AtomicAndy', 'NuclearNick', 'FusionFred', 'PlasmaPatrick', 'IonIgor'
                ];

                const leaderboard = [];

                // Create players at various earning levels
                const tiers = [
                    { min: 0, max: 100, count: 20 },
                    { min: 100, max: 1000, count: 25 },
                    { min: 1000, max: 10000, count: 20 },
                    { min: 10000, max: 100000, count: 15 },
                    { min: 100000, max: 1000000, count: 12 },
                    { min: 1000000, max: 10000000, count: 10 },
                    { min: 10000000, max: 100000000, count: 8 },
                    { min: 100000000, max: 1000000000, count: 6 },
                    { min: 1000000000, max: 10000000000, count: 5 },
                    { min: 10000000000, max: 100000000000, count: 4 },
                    { min: 100000000000, max: 500000000000, count: 3 },
                ];

                let nameIndex = 0;
                tiers.forEach(tier => {
                    for (let i = 0; i < tier.count; i++) {
                        if (nameIndex >= names.length) break;
                        const earnings = tier.min + Math.random() * (tier.max - tier.min);
                        leaderboard.push({
                            name: names[nameIndex],
                            earnings: Math.floor(earnings)
                        });
                        nameIndex++;
                    }
                });

                // Sort by earnings descending
                return leaderboard.sort((a, b) => b.earnings - a.earnings);
            };

            const [leaderboardData] = useState(generateLeaderboard());
            const [playerRank, setPlayerRank] = useState(null);

            // Achievement definitions
            const achievements = [
                { id: 'first_sale', name: 'First Sale!', description: 'Sell your first card', icon: 'ðŸŽ‰', condition: () => totalClicks >= 1 },
                { id: 'hundred_sales', name: 'Hustler', description: 'Make 100 sales', icon: 'ðŸ’ª', condition: () => totalClicks >= 100 },
                { id: 'thousand_sales', name: 'Card Dealer', description: 'Make 1,000 sales', icon: 'ðŸ”¥', condition: () => totalClicks >= 1000 },
                { id: 'ten_thousand_sales', name: 'Trading Legend', description: 'Make 10,000 sales', icon: 'âš¡', condition: () => totalClicks >= 10000 },
                { id: 'hundred_thousand_sales', name: 'Sales Titan', description: 'Make 100,000 sales', icon: 'ðŸ’«', condition: () => totalClicks >= 100000 },
                { id: 'first_thousand', name: 'Getting Started', description: 'Earn $1,000', icon: 'ðŸ’µ', condition: () => totalEarned >= 1000 },
                { id: 'hundred_thousand', name: 'Big Leagues', description: 'Earn $100,000', icon: 'ðŸ’°', condition: () => totalEarned >= 100000 },
                { id: 'one_million', name: 'Card Mogul!', description: 'Earn $1,000,000', icon: 'ðŸ†', condition: () => totalEarned >= 1000000 },
                { id: 'ten_million', name: 'Millionaire Tycoon', description: 'Earn $10,000,000', icon: 'ðŸ‘‘', condition: () => totalEarned >= 10000000 },
                { id: 'hundred_million', name: 'Card Empire', description: 'Earn $100,000,000', icon: 'ðŸŒŸ', condition: () => totalEarned >= 100000000 },
                { id: 'one_billion', name: 'Billionaire Status', description: 'Earn $1,000,000,000', icon: 'ðŸ’Ž', condition: () => totalEarned >= 1000000000 },
                { id: 'ten_billion', name: 'Industry Domination', description: 'Earn $10,000,000,000', icon: 'ðŸ”±', condition: () => totalEarned >= 10000000000 },
                { id: 'hundred_billion', name: 'Card God', description: 'Earn $100,000,000,000', icon: 'âšœï¸', condition: () => totalEarned >= 100000000000 },
                { id: 'first_upgrade', name: 'Investor', description: 'Purchase your first upgrade', icon: 'ðŸ“ˆ', condition: () => portfolio.some(u => u.owned > 0) },
                { id: 'five_upgrades', name: 'Diversified', description: 'Own 5 different upgrade types', icon: 'ðŸŽ¯', condition: () => portfolio.filter(u => u.owned > 0).length >= 5 },
                { id: 'ten_upgrades', name: 'Portfolio Builder', description: 'Own 10 different upgrade types', icon: 'ðŸ“Š', condition: () => portfolio.filter(u => u.owned > 0).length >= 10 },
                { id: 'all_upgrades', name: 'Complete Portfolio', description: 'Own all upgrade types', icon: 'ðŸ…', condition: () => portfolio.every(u => u.owned > 0) },
                { id: 'fifty_total', name: 'Business Expansion', description: 'Own 50 total upgrades', icon: 'ðŸ¢', condition: () => portfolio.reduce((sum, u) => sum + u.owned, 0) >= 50 },
                { id: 'hundred_total', name: 'Enterprise Scale', description: 'Own 100 total upgrades', icon: 'ðŸ­', condition: () => portfolio.reduce((sum, u) => sum + u.owned, 0) >= 100 },
                { id: 'passive_income', name: 'Autopilot', description: 'Generate $1,000/sec passive income', icon: 'ðŸš€', condition: () => cardsPerSecond >= 1000 },
                { id: 'mega_passive', name: 'Money Machine', description: 'Generate $100,000/sec passive income', icon: 'ðŸ¤–', condition: () => cardsPerSecond >= 100000 },
                { id: 'ultra_passive', name: 'Passive Empire', description: 'Generate $1,000,000/sec passive income', icon: 'ðŸŒ', condition: () => cardsPerSecond >= 1000000 }
            ];

            // Calculate stats
            useEffect(() => {
                let clickBonus = 1;
                let autoMoney = 0;

                portfolio.forEach(upgrade => {
                    clickBonus += upgrade.clickBonus * upgrade.owned;
                    autoMoney += upgrade.perSecond * upgrade.owned;
                });

                setClickValue(clickBonus);
                setCardsPerSecond(autoMoney);
            }, [portfolio]);

            // Auto-generate money per second
            useEffect(() => {
                const interval = setInterval(() => {
                    if (cardsPerSecond > 0) {
                        setCash(prev => prev + cardsPerSecond / 10);
                        setTotalEarned(prev => prev + cardsPerSecond / 10);
                    }
                }, 100);

                return () => clearInterval(interval);
            }, [cardsPerSecond]);

            // Check for achievements
            useEffect(() => {
                achievements.forEach(achievement => {
                    if (!unlockedAchievements.includes(achievement.id) && achievement.condition()) {
                        setUnlockedAchievements(prev => [...prev, achievement.id]);
                        setAchievementNotification(achievement);
                        setTimeout(() => setAchievementNotification(null), 5000);
                    }
                });
            }, [totalClicks, totalEarned, portfolio, cardsPerSecond, unlockedAchievements]);

            // Calculate player rank on leaderboard
            useEffect(() => {
                let rank = 1;
                for (let i = 0; i < leaderboardData.length; i++) {
                    if (totalEarned >= leaderboardData[i].earnings) {
                        break;
                    }
                    rank++;
                }
                setPlayerRank(rank);
            }, [totalEarned, leaderboardData]);

            // Handle main click
            const handleClick = (e) => {
                const rect = e.currentTarget.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                setCash(prev => prev + clickValue);
                setTotalEarned(prev => prev + clickValue);
                setTotalClicks(prev => prev + 1);
                setClickAnimation(true);
                setCardFlipAnimation(true);

                // Play sell sound
                playSellSound();

                setTimeout(() => setClickAnimation(false), 100);
                setTimeout(() => setCardFlipAnimation(false), 600);

                // Add floating number
                const id = Date.now();
                setFloatingNumbers(prev => [...prev, { id, value: clickValue, x, y }]);
                setTimeout(() => {
                    setFloatingNumbers(prev => prev.filter(n => n.id !== id));
                }, 1000);

                // Create particles
                const particleCount = 8;
                const newParticles = [];
                for (let i = 0; i < particleCount; i++) {
                    const angle = (Math.PI * 2 * i) / particleCount;
                    const distance = 50 + Math.random() * 50;
                    const particleId = `${id}-${i}`;
                    newParticles.push({
                        id: particleId,
                        x: x,
                        y: y,
                        tx: Math.cos(angle) * distance,
                        ty: Math.sin(angle) * distance,
                        color: theme === 'dark' ? '#D4A574' : '#8B7355'
                    });
                }
                setParticles(prev => [...prev, ...newParticles]);
                setTimeout(() => {
                    setParticles(prev => prev.filter(p => !newParticles.find(np => np.id === p.id)));
                }, 800);
            };

            const buyUpgrade = (id) => {
                const upgrade = portfolio.find(inv => inv.id === id);
                const cost = Math.floor(upgrade.baseCost * Math.pow(1.15, upgrade.owned));

                if (cash >= cost) {
                    setCash(cash - cost);
                    setPortfolio(prev => prev.map(inv =>
                        inv.id === id ? { ...inv, owned: inv.owned + 1 } : inv
                    ));
                    setMessage(`âœ“ Purchased ${upgrade.name}!`);

                    // Play upgrade sound
                    playUpgradeSound();
                } else {
                    setMessage(`Need ${formatMoney(cost - cash)} more!`);
                }
            };

            const getCost = (upgrade) => {
                return Math.floor(upgrade.baseCost * Math.pow(1.15, upgrade.owned));
            };

            const formatMoney = (amount) => {
                if (amount >= 1000000000) {
                    return `$${(amount / 1000000000).toFixed(2)}B`;
                }
                if (amount >= 1000000) {
                    return `$${(amount / 1000000).toFixed(2)}M`;
                }
                if (amount >= 1000) {
                    return `$${(amount / 1000).toFixed(2)}K`;
                }
                return `$${amount.toFixed(2)}`;
            };

            const canAfford = (upgrade) => {
                return cash >= getCost(upgrade);
            };

            return (
                <div className={`min-h-screen ${theme}`} style={{ backgroundColor: currentColors.bg, color: currentColors.text }}>
                    {/* Card Grading Mini-Game Modal */}
                    {showGradingGame && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 smooth-backdrop" style={{ backgroundColor: 'rgba(0, 0, 0, 0.75)' }}>
                            <div className="card-corner border-2 smooth-rounded-lg p-8 max-w-2xl w-full smooth-shadow-lg" style={{
                                backgroundColor: currentColors.bg,
                                borderColor: currentColors.accent,
                                boxShadow: `0 20px 80px ${currentColors.accent}40, 0 0 40px ${currentColors.accent}20`,
                                animation: 'none'
                            }}>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-3xl font-bold flex items-center gap-3">
                                        <Star size={32} style={{ color: currentColors.accent }} />
                                        <span style={{ color: currentColors.text }}>Card Grading Challenge</span>
                                    </h2>
                                    <button
                                        onClick={closeGradingGame}
                                        className="text-2xl font-bold px-3 py-1 rounded-lg hover:scale-110 transition-transform"
                                        style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            color: currentColors.textSecondary,
                                            border: `2px solid ${currentColors.borderLight}`
                                        }}
                                    >
                                        Ã—
                                    </button>
                                </div>

                                {!gameResult ? (
                                    <>
                                        {/* Card Display */}
                                        <div className="card-corner border-2 smooth-rounded p-6 mb-6" style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            borderColor: currentColors.accent
                                        }}>
                                            <div className="text-center mb-4">
                                                <div className="text-xl font-bold mb-2" style={{ color: currentColors.accent }}>
                                                    {currentCard?.year} {currentCard?.playerName}
                                                </div>
                                                <div className="text-sm" style={{ color: currentColors.textSecondary }}>
                                                    Card #{currentCard?.cardNumber}
                                                </div>
                                            </div>

                                            <div className="grid grid-cols-2 gap-4 text-sm">
                                                <div className="border rounded-lg p-3" style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: currentColors.borderLight
                                                }}>
                                                    <div className="font-bold mb-1" style={{ color: currentColors.accent }}>Corners</div>
                                                    <div style={{ color: currentColors.text }}>{currentCard?.condition.corners}</div>
                                                </div>
                                                <div className="border rounded-lg p-3" style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: currentColors.borderLight
                                                }}>
                                                    <div className="font-bold mb-1" style={{ color: currentColors.accent }}>Edges</div>
                                                    <div style={{ color: currentColors.text }}>{currentCard?.condition.edges}</div>
                                                </div>
                                                <div className="border rounded-lg p-3" style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: currentColors.borderLight
                                                }}>
                                                    <div className="font-bold mb-1" style={{ color: currentColors.accent }}>Centering</div>
                                                    <div style={{ color: currentColors.text }}>{currentCard?.condition.centering}</div>
                                                </div>
                                                <div className="border rounded-lg p-3" style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: currentColors.borderLight
                                                }}>
                                                    <div className="font-bold mb-1" style={{ color: currentColors.accent }}>Surface</div>
                                                    <div style={{ color: currentColors.text }}>{currentCard?.condition.surface}</div>
                                                </div>
                                            </div>
                                        </div>

                                        {/* Grade Selection */}
                                        <div className="mb-6">
                                            <div className="text-lg font-bold mb-3 text-center" style={{ color: currentColors.text }}>
                                                What grade would you assign?
                                            </div>
                                            <div className="grid grid-cols-5 gap-2">
                                                {[10, 9, 8, 7, 6, 5, 4, 3, 2, 1].map(grade => (
                                                    <button
                                                        key={grade}
                                                        onClick={() => setSelectedGrade(grade)}
                                                        className={`p-3 rounded-lg border-2 transition-all font-bold ${
                                                            selectedGrade === grade ? 'scale-110' : 'hover:scale-105'
                                                        }`}
                                                        style={{
                                                            backgroundColor: selectedGrade === grade ? currentColors.accent : currentColors.bgSecondary,
                                                            borderColor: selectedGrade === grade ? currentColors.accent : currentColors.borderLight,
                                                            color: selectedGrade === grade && theme === 'dark' ? '#000' : currentColors.text
                                                        }}
                                                    >
                                                        <div className="text-2xl">{grade}</div>
                                                        <div className="text-xs mt-1" style={{
                                                            color: selectedGrade === grade && theme === 'dark' ? '#000' : currentColors.textSecondary
                                                        }}>
                                                            {cardConditions[grade].name}
                                                        </div>
                                                    </button>
                                                ))}
                                            </div>
                                        </div>

                                        {/* Submit Button */}
                                        <button
                                            onClick={submitGrade}
                                            disabled={!selectedGrade}
                                            className={`w-full py-4 smooth-rounded font-bold text-xl transition-all ${
                                                !selectedGrade ? 'opacity-50 cursor-not-allowed' : 'hover:scale-105'
                                            }`}
                                            style={{
                                                backgroundColor: currentColors.accent,
                                                color: theme === 'dark' ? '#000' : '#fff',
                                                boxShadow: `0 5px 20px ${currentColors.accent}40`
                                            }}
                                        >
                                            Submit Grade
                                        </button>
                                    </>
                                ) : (
                                    <>
                                        {/* Results Display */}
                                        <div className="text-center mb-6">
                                            <div className="text-6xl mb-4">
                                                {gameResult.isSuccess ? 'ðŸŽ‰' : 'ðŸ˜”'}
                                            </div>
                                            <div className="text-3xl font-bold mb-2" style={{
                                                color: gameResult.isSuccess ? '#22c55e' : '#ef4444'
                                            }}>
                                                {gameResult.message}
                                            </div>
                                        </div>

                                        <div className="card-corner border-2 smooth-rounded p-6 mb-6" style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            borderColor: currentColors.accent
                                        }}>
                                            <div className="grid grid-cols-2 gap-4 text-center mb-4">
                                                <div>
                                                    <div className="text-sm mb-1" style={{ color: currentColors.textSecondary }}>Correct Grade</div>
                                                    <div className="text-4xl font-bold" style={{ color: currentColors.accent }}>
                                                        {gameResult.correct}
                                                    </div>
                                                    <div className="text-xs mt-1" style={{ color: currentColors.textSecondary }}>
                                                        {cardConditions[gameResult.correct].name}
                                                    </div>
                                                </div>
                                                <div>
                                                    <div className="text-sm mb-1" style={{ color: currentColors.textSecondary }}>Your Grade</div>
                                                    <div className="text-4xl font-bold" style={{
                                                        color: gameResult.isSuccess ? '#22c55e' : '#ef4444'
                                                    }}>
                                                        {gameResult.selected}
                                                    </div>
                                                    <div className="text-xs mt-1" style={{ color: currentColors.textSecondary }}>
                                                        {cardConditions[gameResult.selected].name}
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="text-center pt-4 border-t" style={{ borderColor: currentColors.borderLight }}>
                                                <div className="text-sm mb-1" style={{ color: currentColors.textSecondary }}>Bonus Earned</div>
                                                <div className="text-3xl font-bold" style={{ color: currentColors.accent }}>
                                                    {formatMoney(gameResult.reward)}
                                                </div>
                                            </div>
                                        </div>

                                        <button
                                            onClick={closeGradingGame}
                                            className="w-full py-4 smooth-rounded font-bold text-xl hover:scale-105 transition-all"
                                            style={{
                                                backgroundColor: currentColors.accent,
                                                color: theme === 'dark' ? '#000' : '#fff',
                                                boxShadow: `0 5px 20px ${currentColors.accent}40`
                                            }}
                                        >
                                            Continue Playing
                                        </button>
                                    </>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Settings Modal */}
                    {showSettings && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 smooth-backdrop" style={{ backgroundColor: 'rgba(0, 0, 0, 0.75)' }}>
                            <div className="card-corner border-2 smooth-rounded-lg p-8 max-w-2xl w-full smooth-shadow-lg max-h-[90vh] overflow-y-auto" style={{
                                backgroundColor: currentColors.bg,
                                borderColor: currentColors.accent,
                                boxShadow: `0 20px 80px ${currentColors.accent}40, 0 0 40px ${currentColors.accent}20`
                            }}>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-3xl font-bold flex items-center gap-3">
                                        <Settings size={32} style={{ color: currentColors.accent }} />
                                        <span style={{ color: currentColors.text }}>Settings</span>
                                    </h2>
                                    <button
                                        onClick={() => setShowSettings(false)}
                                        className="text-2xl font-bold px-3 py-1 rounded-lg hover:scale-110 transition-transform"
                                        style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            color: currentColors.textSecondary,
                                            border: `2px solid ${currentColors.borderLight}`
                                        }}
                                    >
                                        Ã—
                                    </button>
                                </div>

                                <div className="space-y-6">
                                    {/* Audio Section */}
                                    <div className="card-corner border smooth-rounded p-5" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.accent
                                    }}>
                                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2" style={{ color: currentColors.text }}>
                                            {soundEnabled ? <Volume2 size={24} style={{ color: currentColors.accent }} /> : <VolumeX size={24} style={{ color: currentColors.accent }} />}
                                            Audio Settings
                                        </h3>

                                        <div className="space-y-4">
                                            <div className="flex items-center justify-between p-3 rounded-lg" style={{
                                                backgroundColor: currentColors.bgTertiary,
                                                border: `1px solid ${currentColors.borderLight}`
                                            }}>
                                                <div>
                                                    <div className="font-bold text-sm" style={{ color: currentColors.text }}>Sound Effects</div>
                                                    <div className="text-xs" style={{ color: currentColors.textSecondary }}>Enable/disable all sounds</div>
                                                </div>
                                                <button
                                                    onClick={() => setSoundEnabled(!soundEnabled)}
                                                    className={`px-4 py-2 rounded-lg font-bold transition-all ${
                                                        soundEnabled ? 'scale-100' : 'opacity-50'
                                                    }`}
                                                    style={{
                                                        backgroundColor: soundEnabled ? currentColors.accent : currentColors.bgTertiary,
                                                        color: soundEnabled && theme === 'dark' ? '#000' : currentColors.text,
                                                        border: `2px solid ${currentColors.accent}`
                                                    }}
                                                >
                                                    {soundEnabled ? 'ON' : 'OFF'}
                                                </button>
                                            </div>

                                            <div>
                                                <div className="flex items-center justify-between mb-2">
                                                    <div className="font-bold text-sm" style={{ color: currentColors.text }}>
                                                        Volume: {volume}%
                                                    </div>
                                                    <button
                                                        onClick={() => {
                                                            playSellSound();
                                                        }}
                                                        className="text-xs px-3 py-1 rounded-lg hover:scale-105 transition-all"
                                                        style={{
                                                            backgroundColor: currentColors.accent,
                                                            color: theme === 'dark' ? '#000' : '#fff'
                                                        }}
                                                    >
                                                        Test Sound
                                                    </button>
                                                </div>
                                                <input
                                                    type="range"
                                                    min="0"
                                                    max="100"
                                                    value={volume}
                                                    onChange={(e) => setVolume(parseInt(e.target.value))}
                                                    className="w-full h-3 rounded-lg appearance-none cursor-pointer"
                                                    style={{
                                                        backgroundColor: currentColors.bgTertiary,
                                                        background: `linear-gradient(to right, ${currentColors.accent} 0%, ${currentColors.accent} ${volume}%, ${currentColors.bgTertiary} ${volume}%, ${currentColors.bgTertiary} 100%)`
                                                    }}
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    {/* Notifications Section */}
                                    <div className="card-corner border smooth-rounded p-5" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.accent
                                    }}>
                                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2" style={{ color: currentColors.text }}>
                                            {notificationsEnabled ? <Bell size={24} style={{ color: currentColors.accent }} /> : <BellOff size={24} style={{ color: currentColors.accent }} />}
                                            Notifications
                                        </h3>

                                        <div className="flex items-center justify-between p-3 rounded-lg" style={{
                                            backgroundColor: currentColors.bgTertiary,
                                            border: `1px solid ${currentColors.borderLight}`
                                        }}>
                                            <div>
                                                <div className="font-bold text-sm" style={{ color: currentColors.text }}>Achievement Notifications</div>
                                                <div className="text-xs" style={{ color: currentColors.textSecondary }}>Show achievement popups</div>
                                            </div>
                                            <button
                                                onClick={() => setNotificationsEnabled(!notificationsEnabled)}
                                                className={`px-4 py-2 rounded-lg font-bold transition-all ${
                                                    notificationsEnabled ? 'scale-100' : 'opacity-50'
                                                }`}
                                                style={{
                                                    backgroundColor: notificationsEnabled ? currentColors.accent : currentColors.bgTertiary,
                                                    color: notificationsEnabled && theme === 'dark' ? '#000' : currentColors.text,
                                                    border: `2px solid ${currentColors.accent}`
                                                }}
                                            >
                                                {notificationsEnabled ? 'ON' : 'OFF'}
                                            </button>
                                        </div>
                                    </div>

                                    {/* Game Info Section */}
                                    <div className="card-corner border smooth-rounded p-5" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.accent
                                    }}>
                                        <h3 className="text-xl font-bold mb-4" style={{ color: currentColors.text }}>
                                            Game Statistics
                                        </h3>

                                        <div className="grid grid-cols-2 gap-3 text-sm">
                                            <div className="p-3 rounded-lg" style={{
                                                backgroundColor: currentColors.bgTertiary,
                                                border: `1px solid ${currentColors.borderLight}`
                                            }}>
                                                <div className="text-xs" style={{ color: currentColors.textSecondary }}>Total Earned</div>
                                                <div className="font-bold" style={{ color: currentColors.accent }}>{formatMoney(totalEarned)}</div>
                                            </div>
                                            <div className="p-3 rounded-lg" style={{
                                                backgroundColor: currentColors.bgTertiary,
                                                border: `1px solid ${currentColors.borderLight}`
                                            }}>
                                                <div className="text-xs" style={{ color: currentColors.textSecondary }}>Total Clicks</div>
                                                <div className="font-bold" style={{ color: currentColors.accent }}>{totalClicks.toLocaleString()}</div>
                                            </div>
                                            <div className="p-3 rounded-lg" style={{
                                                backgroundColor: currentColors.bgTertiary,
                                                border: `1px solid ${currentColors.borderLight}`
                                            }}>
                                                <div className="text-xs" style={{ color: currentColors.textSecondary }}>Per Second</div>
                                                <div className="font-bold" style={{ color: currentColors.accent }}>{formatMoney(cardsPerSecond)}</div>
                                            </div>
                                            <div className="p-3 rounded-lg" style={{
                                                backgroundColor: currentColors.bgTertiary,
                                                border: `1px solid ${currentColors.borderLight}`
                                            }}>
                                                <div className="text-xs" style={{ color: currentColors.textSecondary }}>Achievements</div>
                                                <div className="font-bold" style={{ color: currentColors.accent }}>{unlockedAchievements.length}/{achievements.length}</div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Danger Zone */}
                                    <div className="card-corner border-2 smooth-rounded p-5" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: '#ef4444'
                                    }}>
                                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2" style={{ color: '#ef4444' }}>
                                            <RefreshCw size={24} />
                                            Danger Zone
                                        </h3>

                                        <button
                                            onClick={resetGame}
                                            className="w-full flex items-center justify-center gap-2 p-3 rounded-lg font-bold hover:scale-105 transition-all"
                                            style={{
                                                backgroundColor: '#ef4444',
                                                color: '#fff',
                                                boxShadow: '0 5px 20px rgba(239, 68, 68, 0.4)'
                                            }}
                                        >
                                            <RefreshCw size={20} />
                                            Reset All Progress
                                        </button>
                                        <p className="text-xs mt-2 text-center" style={{ color: currentColors.textSecondary }}>
                                            This will delete all your progress permanently
                                        </p>
                                    </div>

                                    {/* Close Button */}
                                    <button
                                        onClick={() => setShowSettings(false)}
                                        className="w-full py-3 smooth-rounded font-bold hover:scale-105 transition-all"
                                        style={{
                                            backgroundColor: currentColors.accent,
                                            color: theme === 'dark' ? '#000' : '#fff',
                                            boxShadow: `0 5px 20px ${currentColors.accent}40`
                                        }}
                                    >
                                        Close Settings
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Achievement Notification */}
                    {achievementNotification && notificationsEnabled && (
                        <div className="fixed top-20 left-1/2 transform -translate-x-1/2 z-50 animate-bounce">
                            <div className="card-corner border-2 smooth-rounded p-6 smooth-shadow-lg min-w-[320px]" style={{
                                backgroundColor: currentColors.bgSecondary,
                                borderColor: currentColors.accent,
                                boxShadow: `0 0 30px ${currentColors.accent}40`
                            }}>
                                <div className="text-center">
                                    <div className="text-5xl mb-2 drop-smooth-shadow">{achievementNotification.icon}</div>
                                    <div className="text-sm font-bold uppercase tracking-wide mb-1" style={{ color: currentColors.accent }}>Achievement Unlocked!</div>
                                    <h3 className="text-2xl font-extrabold mb-1 drop-shadow-md" style={{ color: currentColors.text }}>{achievementNotification.name}</h3>
                                    <p className="text-sm" style={{ color: currentColors.textSecondary }}>{achievementNotification.description}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Top Bar - CardFindz Branding */}
                    <div className="sticky top-0 z-10 border-b" style={{ backgroundColor: currentColors.bg, borderColor: currentColors.borderLight }}>
                        <div className="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="card-corner w-12 h-12 rounded-lg flex items-center justify-center smooth-shadow" style={{ backgroundColor: currentColors.accent, color: currentColors.text }}>
                                    <CreditCard size={28} className={theme === 'dark' ? 'text-black' : 'text-white'} strokeWidth={2.5} />
                                </div>
                                <div>
                                    <div className="text-2xl font-bold tracking-tight" style={{
                                        fontFamily: "'Playfair Display', serif",
                                        color: currentColors.text
                                    }}>CardFindz</div>
                                    <div className="text-xs font-medium" style={{ color: currentColors.textSecondary }}>Sports Card Empire</div>
                                </div>
                            </div>
                            <div className="flex items-center gap-4">
                                <div className="text-right">
                                    <div className="text-xs font-semibold uppercase tracking-wide" style={{ color: currentColors.textSecondary }}>Total Cash</div>
                                    <div className="text-2xl font-bold" style={{ color: currentColors.accent }}>{formatMoney(cash)}</div>
                                </div>
                                <button
                                    onClick={() => setShowSettings(true)}
                                    className="p-2 rounded-lg transition-all hover:scale-110"
                                    style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        border: `2px solid ${currentColors.accent}`,
                                        color: currentColors.accent
                                    }}
                                    title="Settings"
                                >
                                    <Settings size={20} />
                                </button>
                                <button
                                    onClick={toggleTheme}
                                    className="p-2 rounded-lg transition-all hover:scale-110"
                                    style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        border: `2px solid ${currentColors.accent}`,
                                        color: currentColors.accent
                                    }}
                                    title={`Switch to ${theme === 'dark' ? 'light' : 'dark'} mode`}
                                >
                                    {theme === 'dark' ? <Sun size={20} /> : <Moon size={20} />}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto grid lg:grid-cols-2 gap-0 lg:gap-8 min-h-screen">
                        {/* Left Side - Click Area */}
                        <div className="p-6 lg:p-8 flex flex-col justify-center items-center border-b lg:border-b-0 lg:border-r" style={{
                            backgroundColor: currentColors.bg,
                            borderColor: currentColors.borderLight
                        }}>
                            <div className="w-full max-w-md space-y-6">
                                {/* Stats */}
                                <div className="space-y-3">
                                    <div className="card-corner card-texture border smooth-rounded p-6 smooth-shadow" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.accent
                                    }}>
                                        <div className="text-xs uppercase tracking-wide font-bold mb-1" style={{ color: currentColors.textSecondary }}>Total Earnings</div>
                                        <div className="text-4xl font-bold" style={{ color: currentColors.accent }}>{formatMoney(totalEarned)}</div>
                                    </div>

                                    {/* Leaderboard Rank */}
                                    <div className="card-corner border smooth-rounded p-4 smooth-shadow" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.accent
                                    }}>
                                        <div className="flex items-center justify-between mb-2">
                                            <div className="flex items-center gap-2">
                                                <Trophy size={20} style={{ color: currentColors.accent }} />
                                                <div className="text-xs uppercase tracking-wide font-bold" style={{ color: currentColors.textSecondary }}>
                                                    Global Rank
                                                </div>
                                            </div>
                                            <div className="text-2xl font-bold" style={{ color: currentColors.accent }}>
                                                #{playerRank}
                                            </div>
                                        </div>
                                        {playerRank && playerRank > 1 && (() => {
                                            const nextPlayer = leaderboardData[playerRank - 2];
                                            const needed = nextPlayer.earnings - totalEarned;
                                            const progress = Math.min((totalEarned / nextPlayer.earnings) * 100, 100);
                                            return (
                                                <div>
                                                    <div className="text-xs mb-1" style={{ color: currentColors.textSecondary }}>
                                                        Next: {nextPlayer.name} ({formatMoney(needed)} away)
                                                    </div>
                                                    <div className="h-2 rounded-full overflow-hidden" style={{
                                                        backgroundColor: currentColors.bgTertiary,
                                                        border: `1px solid ${currentColors.borderLight}`
                                                    }}>
                                                        <div
                                                            className="h-full transition-all duration-300"
                                                            style={{
                                                                width: `${progress}%`,
                                                                backgroundColor: currentColors.accent,
                                                                boxShadow: `0 0 10px ${currentColors.accent}`
                                                            }}
                                                        />
                                                    </div>
                                                </div>
                                            );
                                        })()}
                                        {playerRank === 1 && (
                                            <div className="text-center text-xs font-bold" style={{ color: currentColors.accent }}>
                                                ðŸ† #1 RANK! ðŸ†
                                            </div>
                                        )}
                                    </div>

                                    <div className="grid grid-cols-3 gap-3">
                                        <div className="border rounded-lg p-4 shadow" style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            borderColor: currentColors.borderLight
                                        }}>
                                            <div className="text-xs uppercase tracking-wide font-semibold mb-1" style={{ color: currentColors.textSecondary }}>Per Sale</div>
                                            <div className="text-xl font-bold" style={{ color: currentColors.text }}>{formatMoney(clickValue)}</div>
                                        </div>
                                        <div className="border rounded-lg p-4 shadow" style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            borderColor: currentColors.borderLight
                                        }}>
                                            <div className="text-xs uppercase tracking-wide font-semibold mb-1" style={{ color: currentColors.textSecondary }}>Per Second</div>
                                            <div className="text-xl font-bold" style={{ color: currentColors.text }}>{formatMoney(cardsPerSecond)}</div>
                                        </div>
                                        <div className="border rounded-lg p-4 shadow" style={{
                                            backgroundColor: currentColors.bgSecondary,
                                            borderColor: currentColors.borderLight
                                        }}>
                                            <div className="text-xs uppercase tracking-wide font-semibold mb-1" style={{ color: currentColors.textSecondary }}>Total Sales</div>
                                            <div className="text-xl font-bold" style={{ color: currentColors.text }}>{totalClicks.toLocaleString()}</div>
                                        </div>
                                    </div>
                                </div>

                                {/* Click Button */}
                                <div className="relative">
                                    <button
                                        onClick={handleClick}
                                        className={`card-corner w-full aspect-square active:scale-95 smooth-rounded-lg transition-all duration-100 flex flex-col items-center justify-center gap-4 smooth-shadow-lg ${
                                            clickAnimation ? 'scale-95' : 'scale-100'
                                        } ${cardFlipAnimation ? 'animate-card-flip' : ''}`}
                                        style={{
                                            backgroundColor: currentColors.accent,
                                            boxShadow: `0 10px 40px ${currentColors.accent}60`
                                        }}
                                        onMouseEnter={(e) => e.target.style.backgroundColor = currentColors.accentHover}
                                        onMouseLeave={(e) => e.target.style.backgroundColor = currentColors.accent}
                                    >
                                        <CreditCard size={80} className={theme === 'dark' ? 'text-black' : 'text-white'} strokeWidth={2.5} />
                                        <span className={`text-3xl font-bold tracking-tight ${theme === 'dark' ? 'text-black' : 'text-white'}`}>SELL CARD</span>
                                        <span className={`text-sm font-medium ${theme === 'dark' ? 'text-black/70' : 'text-white/70'}`}>Click to sell!</span>
                                    </button>

                                    {/* Floating numbers */}
                                    {floatingNumbers.map(num => (
                                        <div
                                            key={num.id}
                                            className="absolute font-bold text-3xl pointer-events-none animate-float"
                                            style={{
                                                left: num.x,
                                                top: num.y,
                                                color: currentColors.accent,
                                                textShadow: `0 0 10px ${currentColors.accent}`
                                            }}
                                        >
                                            +{formatMoney(num.value)}
                                        </div>
                                    ))}

                                    {/* Particles */}
                                    {particles.map(particle => (
                                        <div
                                            key={particle.id}
                                            className="particle"
                                            style={{
                                                left: particle.x,
                                                top: particle.y,
                                                backgroundColor: particle.color,
                                                '--tx': `${particle.tx}px`,
                                                '--ty': `${particle.ty}px`
                                            }}
                                        />
                                    ))}
                                </div>

                                {/* Grade Cards Button */}
                                <div className="relative">
                                    <button
                                        onClick={startGradingGame}
                                        disabled={gradingCooldown > 0}
                                        className={`card-corner w-full smooth-rounded transition-all duration-200 flex items-center justify-center gap-3 smooth-shadow py-4 ${
                                            gradingCooldown > 0 ? 'opacity-50 cursor-not-allowed' : 'hover:scale-105'
                                        }`}
                                        style={{
                                            backgroundColor: gradingCooldown > 0 ? currentColors.bgTertiary : currentColors.bgSecondary,
                                            border: `2px solid ${currentColors.accent}`,
                                            color: currentColors.text
                                        }}
                                    >
                                        <Star size={24} style={{ color: currentColors.accent }} />
                                        <span className="text-lg font-bold">
                                            {gradingCooldown > 0 ? `Cooldown: ${gradingCooldown}s` : 'GRADE CARDS'}
                                        </span>
                                        {gradingCooldown === 0 && <Zap size={24} style={{ color: currentColors.accent }} />}
                                    </button>
                                </div>

                                {/* Message */}
                                <div className="text-center">
                                    <div className="text-sm border rounded-lg py-3 px-5 font-medium" style={{
                                        color: currentColors.textSecondary,
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.borderLight
                                    }}>
                                        {message}
                                    </div>
                                </div>

                                {/* Mini-game Stats */}
                                {totalGradingGames > 0 && (
                                    <div className="border rounded-lg p-3 text-xs" style={{
                                        backgroundColor: currentColors.bgSecondary,
                                        borderColor: currentColors.borderLight,
                                        color: currentColors.textSecondary
                                    }}>
                                        <div className="font-bold mb-1" style={{ color: currentColors.accent }}>Grading Stats</div>
                                        <div>Games Played: {totalGradingGames}</div>
                                        <div>Perfect Grades: {perfectGrades}</div>
                                        <div>Accuracy: {((perfectGrades / totalGradingGames) * 100).toFixed(1)}%</div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Right Side - Upgrades */}
                        <div className="p-6 lg:p-8 overflow-y-auto" style={{
                            backgroundColor: currentColors.bg,
                            maxHeight: 'calc(100vh - 89px)'
                        }}>
                            <h2 className="text-2xl font-bold mb-6 flex items-center gap-3">
                                <Package size={28} style={{ color: currentColors.accent }} />
                                <span style={{ color: currentColors.text }}>Business Upgrades</span>
                            </h2>

                            <div className="space-y-2.5 mb-8">
                                {portfolio.map((upgrade) => {
                                    const Icon = upgrade.icon;
                                    const cost = getCost(upgrade);
                                    const affordable = canAfford(upgrade);

                                    return (
                                        <button
                                            key={upgrade.id}
                                            onClick={() => buyUpgrade(upgrade.id)}
                                            disabled={!affordable}
                                            className={`w-full rounded-lg p-4 transition-all duration-150 text-left border ${
                                                affordable ? '' : 'opacity-40 cursor-not-allowed'
                                            }`}
                                            style={{
                                                backgroundColor: currentColors.bgSecondary,
                                                borderColor: currentColors.borderLight
                                            }}
                                            onMouseEnter={(e) => affordable && (e.currentTarget.style.borderColor = currentColors.accent)}
                                            onMouseLeave={(e) => (e.currentTarget.style.borderColor = currentColors.borderLight)}
                                        >
                                            <div className="flex items-start gap-4">
                                                <div className={`p-3 rounded-lg ${affordable ? '' : ''}`} style={{
                                                    backgroundColor: affordable ? currentColors.accent : currentColors.bgTertiary
                                                }}>
                                                    <Icon size={24} className={affordable && theme === 'dark' ? 'text-black' : affordable && theme === 'light' ? 'text-white' : ''} style={{
                                                        color: !affordable ? currentColors.textTertiary : undefined
                                                    }} />
                                                </div>

                                                <div className="flex-1 min-w-0">
                                                    <div className="flex items-start justify-between gap-2 mb-1">
                                                        <h3 className="font-bold text-base" style={{ color: currentColors.text }}>{upgrade.name}</h3>
                                                        <div className={`text-sm font-bold whitespace-nowrap`} style={{
                                                            color: affordable ? currentColors.text : currentColors.textTertiary
                                                        }}>
                                                            {formatMoney(cost)}
                                                        </div>
                                                    </div>

                                                    <p className="text-xs mb-2" style={{ color: currentColors.textSecondary }}>{upgrade.description}</p>

                                                    {/* Progress Bar */}
                                                    <div className="mb-2">
                                                        <div className="h-2 rounded-full overflow-hidden" style={{
                                                            backgroundColor: currentColors.bgTertiary,
                                                            border: `1px solid ${currentColors.borderLight}`
                                                        }}>
                                                            <div
                                                                className="h-full transition-all duration-300 rounded-full"
                                                                style={{
                                                                    width: `${Math.min((cash / cost) * 100, 100)}%`,
                                                                    backgroundColor: affordable ? currentColors.accent : currentColors.textTertiary,
                                                                    boxShadow: affordable ? `0 0 10px ${currentColors.accent}` : 'none'
                                                                }}
                                                            />
                                                        </div>
                                                        {!affordable && (
                                                            <div className="text-xs mt-1" style={{ color: currentColors.textTertiary }}>
                                                                {formatMoney(cost - cash)} more needed
                                                            </div>
                                                        )}
                                                    </div>

                                                    <div className="flex items-center justify-between">
                                                        <div className="text-xs" style={{ color: currentColors.textTertiary }}>
                                                            Owned: <span className="font-bold" style={{ color: currentColors.text }}>{upgrade.owned}</span>
                                                        </div>
                                                        {upgrade.owned > 0 && (
                                                            <div className="text-xs font-bold" style={{ color: currentColors.accent }}>
                                                                {upgrade.perSecond > 0
                                                                    ? `+${formatMoney(upgrade.perSecond * upgrade.owned)}/sec`
                                                                    : `+${formatMoney(upgrade.clickBonus * upgrade.owned)}/sale`
                                                                }
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>

                            {/* Achievements */}
                            <div className="card-corner border smooth-rounded p-6 smooth-shadow" style={{
                                backgroundColor: currentColors.bgSecondary,
                                borderColor: currentColors.accent
                            }}>
                                <div className="flex items-center justify-between mb-5">
                                    <div>
                                        <h3 className="text-xl font-bold" style={{ color: currentColors.text }}>Achievements</h3>
                                        <p className="text-xs mt-1" style={{ color: currentColors.textSecondary }}>
                                            {unlockedAchievements.length} / {achievements.length} Unlocked
                                        </p>
                                    </div>
                                    <div className="text-4xl drop-smooth-shadow">ðŸ†</div>
                                </div>

                                <div className="space-y-2 max-h-[400px] overflow-y-auto pr-2">
                                    {achievements.map((achievement) => {
                                        const isUnlocked = unlockedAchievements.includes(achievement.id);
                                        return (
                                            <div
                                                key={achievement.id}
                                                className={`p-4 rounded-lg border transition-all ${
                                                    isUnlocked ? '' : 'opacity-40'
                                                }`}
                                                style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: isUnlocked ? currentColors.accent : currentColors.borderLight
                                                }}
                                            >
                                                <div className="flex items-start gap-3">
                                                    <div className={`text-3xl drop-smooth-shadow ${isUnlocked ? '' : 'grayscale opacity-40'}`}>
                                                        {achievement.icon}
                                                    </div>
                                                    <div className="flex-1 min-w-0">
                                                        <h4 className={`font-bold text-sm`} style={{
                                                            color: isUnlocked ? currentColors.text : currentColors.textTertiary
                                                        }}>
                                                            {achievement.name}
                                                        </h4>
                                                        <p className={`text-xs mt-0.5`} style={{
                                                            color: isUnlocked ? currentColors.textSecondary : currentColors.textTertiary
                                                        }}>
                                                            {achievement.description}
                                                        </p>
                                                    </div>
                                                    {isUnlocked && (
                                                        <div className="text-xl drop-smooth-shadow" style={{ color: currentColors.accent }}>âœ“</div>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Leaderboard */}
                            <div className="card-corner border smooth-rounded p-6 smooth-shadow mt-6" style={{
                                backgroundColor: currentColors.bgSecondary,
                                borderColor: currentColors.accent
                            }}>
                                <div className="flex items-center justify-between mb-5">
                                    <div>
                                        <h3 className="text-xl font-bold" style={{ color: currentColors.text }}>Global Leaderboard</h3>
                                        <p className="text-xs mt-1" style={{ color: currentColors.textSecondary }}>
                                            Your Rank: #{playerRank} / {leaderboardData.length + 1}
                                        </p>
                                    </div>
                                    <div className="text-4xl drop-smooth-shadow">
                                        <Trophy size={32} style={{ color: currentColors.accent }} />
                                    </div>
                                </div>

                                <div className="space-y-1.5 max-h-[500px] overflow-y-auto pr-2">
                                    {/* Show top 3 players */}
                                    {leaderboardData.slice(0, 3).map((player, index) => {
                                        const rank = index + 1;
                                        const isPlayer = false;
                                        const medals = ['ðŸ¥‡', 'ðŸ¥ˆ', 'ðŸ¥‰'];

                                        return (
                                            <div
                                                key={`top-${player.name}`}
                                                className={`p-3 rounded-lg border transition-all ${
                                                    isPlayer ? 'ring-2' : ''
                                                }`}
                                                style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: rank <= 3 ? currentColors.accent : currentColors.borderLight,
                                                    ringColor: currentColors.accent
                                                }}
                                            >
                                                <div className="flex items-center justify-between">
                                                    <div className="flex items-center gap-3">
                                                        <div className="text-2xl drop-smooth-shadow w-8 text-center">
                                                            {medals[index]}
                                                        </div>
                                                        <div>
                                                            <div className="font-bold text-sm" style={{ color: currentColors.text }}>
                                                                {player.name}
                                                            </div>
                                                            <div className="text-xs" style={{ color: currentColors.textSecondary }}>
                                                                Rank #{rank}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="font-bold text-sm" style={{ color: currentColors.accent }}>
                                                            {formatMoney(player.earnings)}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}

                                    {/* Show players around user's rank */}
                                    {playerRank && (() => {
                                        const playersToShow = [];
                                        const showRadius = 3; // Show 3 players above and below

                                        // Calculate range to show
                                        const startIdx = Math.max(3, playerRank - showRadius - 1);
                                        const endIdx = Math.min(leaderboardData.length, playerRank + showRadius);

                                        // Add players before the user
                                        for (let i = startIdx; i < Math.min(playerRank - 1, leaderboardData.length); i++) {
                                            const player = leaderboardData[i];
                                            const rank = i + 1;
                                            playersToShow.push(
                                                <div
                                                    key={player.name}
                                                    className="p-3 rounded-lg border"
                                                    style={{
                                                        backgroundColor: currentColors.bgTertiary,
                                                        borderColor: currentColors.borderLight
                                                    }}
                                                >
                                                    <div className="flex items-center justify-between">
                                                        <div className="flex items-center gap-3">
                                                            <div className="text-sm font-bold w-8 text-center" style={{ color: currentColors.textSecondary }}>
                                                                #{rank}
                                                            </div>
                                                            <div>
                                                                <div className="font-bold text-sm" style={{ color: currentColors.text }}>
                                                                    {player.name}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="text-right">
                                                            <div className="font-bold text-sm" style={{ color: currentColors.textSecondary }}>
                                                                {formatMoney(player.earnings)}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        }

                                        // Add the player (YOU)
                                        playersToShow.push(
                                            <div
                                                key="player"
                                                className="p-4 rounded-lg border-2 ring-2"
                                                style={{
                                                    backgroundColor: currentColors.bgTertiary,
                                                    borderColor: currentColors.accent,
                                                    ringColor: currentColors.accent,
                                                    boxShadow: `0 0 20px ${currentColors.accent}40`
                                                }}
                                            >
                                                <div className="flex items-center justify-between">
                                                    <div className="flex items-center gap-3">
                                                        <div className="text-sm font-bold w-8 text-center" style={{ color: currentColors.accent }}>
                                                            #{playerRank}
                                                        </div>
                                                        <div>
                                                            <div className="font-bold text-sm flex items-center gap-2" style={{ color: currentColors.accent }}>
                                                                YOU
                                                                <span className="text-xs px-2 py-0.5 rounded" style={{
                                                                    backgroundColor: currentColors.accent,
                                                                    color: theme === 'dark' ? '#000' : '#fff'
                                                                }}>
                                                                    Player
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="font-bold text-sm" style={{ color: currentColors.accent }}>
                                                            {formatMoney(totalEarned)}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        );

                                        // Add players after the user
                                        for (let i = playerRank - 1; i < endIdx; i++) {
                                            if (i < leaderboardData.length) {
                                                const player = leaderboardData[i];
                                                const rank = i + 2; // +2 because player takes rank at playerRank
                                                playersToShow.push(
                                                    <div
                                                        key={player.name}
                                                        className="p-3 rounded-lg border"
                                                        style={{
                                                            backgroundColor: currentColors.bgTertiary,
                                                            borderColor: currentColors.borderLight
                                                        }}
                                                    >
                                                        <div className="flex items-center justify-between">
                                                            <div className="flex items-center gap-3">
                                                                <div className="text-sm font-bold w-8 text-center" style={{ color: currentColors.textSecondary }}>
                                                                    #{rank}
                                                                </div>
                                                                <div>
                                                                    <div className="font-bold text-sm" style={{ color: currentColors.text }}>
                                                                        {player.name}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div className="text-right">
                                                                <div className="font-bold text-sm" style={{ color: currentColors.textSecondary }}>
                                                                    {formatMoney(player.earnings)}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            }
                                        }

                                        return playersToShow;
                                    })()}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CardFindzTycoon />, document.getElementById('root'));
    </script>
</body>
</html>
